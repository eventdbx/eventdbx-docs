---
title: "Watch / Push / Pull"
description: "Explain replication commands and automation patterns."
---

Three commands cover replication needs: `watch` for continuous sync, `push` for one-way transfers, and `pull` for ingesting from a remote. Mix them to match your latency and workflow goals.

## watch

Streams changes continuously with automatic retries and backoff.

```bash
dbx watch standby-a --mode push --background
dbx watch primary --mode pull --aggregate patient
dbx watch peer-1 --mode bidirectional --aggregate patient --id p-001 --run-once
```

- Modes: `push` (send to remote), `pull` (ingest from remote), `bidirectional` (sync both ways).
- Scopes: `--aggregate <type>` and `--id <aggregate_id>` to target specific streams.
- Flags: `--background` to daemonise, `--run-once` for single pass, `--skip-if-active` to avoid overlapping runs, `--concurrency <threads>` to tune parallelism.

## push

Initiates a one-off transfer from the active domain to a remote.

```bash
dbx push standby-b
dbx push standby-b --aggregate patient --id p-001
```

- Scopes: `--aggregate <type>` and `--id <aggregate_id>` to narrow the transfer.
- Throughput: `--concurrency <threads>` to tune parallelism (defaults to CPU count).

## pull

Runs from the standby to fetch updates from a remote.

```bash
dbx pull primary
dbx pull primary --aggregate patient --id p-001
```

- Scopes: `--aggregate <type>` and `--id <aggregate_id>` to narrow the transfer.
- Throughput: `--concurrency <threads>` to tune parallelism (defaults to CPU count).

## Monitoring and retries

- Commands exit non-zero on failure; wrap them in scripts that retry with backoff or let `watch` run continuously.
- Monitor replication metrics from `/metrics` (Prometheus):

```
eventdbx_replication_events_total{target="standby-a"} 123456
eventdbx_replication_lag_seconds{target="standby-a"} 12
```

## Failure recovery

1. Identify the last successful aggregate/version (from logs or metrics).
2. Rerun `dbx push|pull` scoped to the affected aggregate(s), or restart `dbx watch` (it resumes from its cursor).
3. If a divergence is detected, choose the authoritative side, reseed the other with `push|pull`, and restart `watch`.

Combining these commands lets you tailor replication for low-latency mirrors, standby recovery, or mesh syncs without risking silent history rewrites.
